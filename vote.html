<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 ë°©íƒˆì¶œ ì¥ë¥´ë³„ ìš°ìˆ˜ í…Œë§ˆ íˆ¬í‘œ</title>
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .badge-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .badge {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            cursor: grab;
            transition: transform 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .badge:active {
            cursor: grabbing;
        }
        
        .badge:hover {
            transform: scale(1.1);
        }
        
        .badge.gold {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
        }
        
        .badge.silver {
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
        }
        
        .badge.bronze {
            background: linear-gradient(135deg, #cd7f32, #e69a5a);
        }
        
        .badge.dragging {
            opacity: 0.5;
        }
        
        .category {
            margin-bottom: 50px;
        }
        
        .category-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .themes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .theme-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            background: white;
            transition: all 0.3s;
            position: relative;
        }
        
        .theme-card:hover {
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            transform: translateY(-5px);
        }
        
        .theme-card.drop-zone-active {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .theme-poster {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
            background: #f5f5f5;
        }
        
        .theme-name {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        
        .store-name {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .badge-drop-zone {
            min-height: 50px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            background: #fafafa;
        }
        
        .badge-drop-zone.has-badge {
            border-style: solid;
            border-color: transparent;
            background: transparent;
        }
        
        .placed-badge {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            cursor: pointer;
        }
        
        .submit-btn {
            display: block;
            width: 300px;
            margin: 40px auto;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .submit-btn:hover {
            transform: scale(1.05);
        }
        
        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .results-container {
            display: none;
        }
        
        .results-container.show {
            display: block;
        }
        
        .result-category {
            margin-bottom: 40px;
        }
        
        .result-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .result-rank {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            margin-right: 15px;
            min-width: 40px;
        }
        
        .result-info {
            flex: 1;
        }
        
        .result-theme {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .result-store {
            color: #666;
            font-size: 0.9em;
        }
        
        .result-points {
            font-size: 1.2em;
            font-weight: bold;
            color: #764ba2;
            margin-left: 20px;
        }
        
        .result-badges {
            display: flex;
            gap: 10px;
            margin-left: 20px;
        }
        
        .result-badge-count {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9em;
        }
        
        .store-rankings {
            margin-top: 50px;
            padding: 30px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border-radius: 15px;
        }
        
        .store-rankings h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }
        
        .store-rank-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #667eea;
        }
        
        .error {
            text-align: center;
            padding: 20px;
            background: #fee;
            color: #c00;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .info-box {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }
        
        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .info-box ul {
            margin-left: 20px;
            color: #555;
        }
        
        .info-box li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ­ 2025 ë°©íƒˆì¶œ ì¥ë¥´ë³„ ìš°ìˆ˜ í…Œë§ˆ íˆ¬í‘œ</h1>
        <p class="subtitle">ê° ë¶€ë¬¸ë³„ë¡œ ê¸ˆğŸ¥‡Â·ì€ğŸ¥ˆÂ·ë™ğŸ¥‰ ë©”ë‹¬ì„ ë“œë˜ê·¸í•˜ì—¬ í…Œë§ˆì— ë°°ì¹˜í•´ì£¼ì„¸ìš”!</p>
        
        <div id="votingSection">
            <div class="info-box">
                <h3>ğŸ“‹ íˆ¬í‘œ ë°©ë²•</h3>
                <ul>
                    <li>ê° ë¶€ë¬¸ë³„ë¡œ ê¸ˆğŸ¥‡Â·ì€ğŸ¥ˆÂ·ë™ğŸ¥‰ ë©”ë‹¬ì„ í…Œë§ˆ ì¹´ë“œì— ë“œë˜ê·¸í•˜ì—¬ ë°°ì¹˜í•˜ì„¸ìš”</li>
                    <li>í”Œë ˆì´í•˜ì§€ ì•Šì€ í…Œë§ˆëŠ” ë©”ë‹¬ì„ ë°°ì¹˜í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤</li>
                    <li>1ê°œì˜ í…Œë§ˆì—ë§Œ ë©”ë‹¬ì„ ì£¼ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
                    <li>ë°°ì¹˜í•œ ë©”ë‹¬ì„ í´ë¦­í•˜ë©´ ë‹¤ì‹œ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                </ul>
            </div>
            
            <div id="categoriesContainer"></div>
            
            <button class="submit-btn" onclick="submitVote()">íˆ¬í‘œ ì œì¶œí•˜ê¸°</button>
        </div>
        
        <div id="resultsSection" class="results-container">
            <h2 style="text-align: center; margin-bottom: 30px;">ğŸ“Š íˆ¬í‘œ ê²°ê³¼</h2>
            <div id="resultsContainer"></div>
            <div class="store-rankings">
                <h2>ğŸ† TOP 5 ë§¤ì¥</h2>
                <div id="storeRankings"></div>
            </div>
        </div>
    </div>

    <script>
        // API ì—”ë“œí¬ì¸íŠ¸ (API í‚¤ëŠ” ì„œë²„ì—ì„œ ê´€ë¦¬)
        const API_URL = 'https://zucyrthaumdzgwtddren.supabase.co/functions/v1/vote-api';
        
        // í…Œë§ˆ ë°ì´í„°
        const themes = [
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'ë‚˜í´ë¦¬íƒ„', store: 'ë‘ ì´ìŠ¤ì¼€ì´í”„ 1í˜¸ì '},
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'ë²„ë””', store: 'ì˜¤ëŠ˜ì˜ í•œ í˜ì´ì§€'},
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'ì•…ë…€ - ì€í™”ê¸°ìˆ™í•™ì›', store: 'ëŸ¬ì‹œì•„ì›Œ ì‹œë„¤ë§ˆí‹±'},
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'í”¼ë…¸í‚¤ì˜¤', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'AYAKO', store: 'í›„ì¦ˆë°ì–´'},
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'Chapter 01 : ì„ íƒ', store: 'ë”ì±•í„°'},
            {category: 'ê³µí¬ ë¶€ë¬¸', name: 'PIG', store: 'ì‡¼ë£¸'},
            {category: 'ê°ì„±/ë¡œë§¨ìŠ¤/íŒíƒ€ì§€ ë¶€ë¬¸', name: 'ì™¸ë¡œì›€ê³¼ ê³ ë…ì‚¬ì´', store: 'ìµìŠ¤í”Œë¡œë¦¬ì•„ ì´ìŠ¤ì¼€ì´í”„'},
            {category: 'ê°ì„±/ë¡œë§¨ìŠ¤/íŒíƒ€ì§€ ë¶€ë¬¸', name: 'í”Œë¼ì´ ë¯¸ íˆ¬ ë” ë¬¸', store: 'ë£¸ìµìŠ¤ì¼€ì´í”„ ì¸ë””ê³ ë¸”ë£¨ì '},
            {category: 'ê°ì„±/ë¡œë§¨ìŠ¤/íŒíƒ€ì§€ ë¶€ë¬¸', name: 'í–‰ë³µëª©ìš•íƒ•', store: 'ìƒìƒì˜ë¬¸ ë¶€í‰ì '},
            {category: 'ê°ì„±/ë¡œë§¨ìŠ¤/íŒíƒ€ì§€ ë¶€ë¬¸', name: 'í–‰ìš´ì˜ ë°°ë‹¬ë¶€ ë£¨ì‹œ', store: 'ì…œë¡í™ˆì¦ˆ ë¶€ì²œì¤‘ë™ì '},
            {category: 'ê°ì„±/ë¡œë§¨ìŠ¤/íŒíƒ€ì§€ ë¶€ë¬¸', name: 'Les Portrait', store: 'ì´ˆìƒí™”'},
            {category: 'SF/ì•¡ì…˜/ì–´ë“œë²¤ì³ ë¶€ë¬¸', name: 'ì•„ë‚´, ìœ í•˜ë¦° 37ì„¸', store: 'ì…œë¡í™ˆì¦ˆ ì ì‹¤ìƒˆë‚´ì '},
            {category: 'SF/ì•¡ì…˜/ì–´ë“œë²¤ì³ ë¶€ë¬¸', name: 'ì¹´ë¶€íŠ¸', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ë¼ìŠ¤íŠ¸ì‹œí‹°ì '},
            {category: 'SF/ì•¡ì…˜/ì–´ë“œë²¤ì³ ë¶€ë¬¸', name: 'alone', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ë¼ìŠ¤íŠ¸ì‹œí‹°ì '},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'ë‘ê»ì•„ ë‘ê»ì•„ í—Œì§‘ì¤„ê²Œ ìƒˆì§‘ë‹¤ì˜¤', store: 'í† ë¼êµ´'},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'ìƒì¡´ì', store: 'ë„¥ìŠ¤íŠ¸ì—ë””ì…˜ ê±´ëŒ€ 2í˜¸ì '},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'ì˜¤ëª¨í…Œë‚˜ì‹œ', store: 'ì„œìš¸ì´ìŠ¤ì¼€ì´í”„ë£¸ ëŒ€êµ¬ë™ì„±ë¡œì '},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'ì”í–¥', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'íˆ¬íˆ¬ ì–´ë“œë²¤ì³', store: 'í›„ì¦ˆë°ì–´'},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'Chapter 02 : ì¿ í‚¤', store: 'ë”ì±•í„°'},
            {category: 'ìŠ¤ë¦´ëŸ¬/ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬ ë¶€ë¬¸', name: 'NOSTALGIA VISTA', store: 'í‚¤ì´ìŠ¤ì¼€ì´í”„ ê°•ë‚¨ ìŠ¤í…Œì´ì…˜ì '},
            {category: 'ë¬¸ì œ/ì•„ì¼€ì´ë“œ ë¶€ë¬¸', name: 'ê²Œì„ì˜ ë²•ì¹™', store: 'í‹°ì¼“ íˆ¬ ì´ìŠ¤ì¼€ì´í”„'},
            {category: 'ë¬¸ì œ/ì•„ì¼€ì´ë“œ ë¶€ë¬¸', name: 'ë©”ê°€ ê²Œì„', store: 'ë£¸ì¦ˆì—ì´ ê°•ë‚¨ì '},
            {category: 'ë¬¸ì œ/ì•„ì¼€ì´ë“œ ë¶€ë¬¸', name: 'í•˜ì´ ë§¥ìŠ¤', store: 'ì˜¤ì•„ì‹œìŠ¤'},
            {category: 'ë¬¸ì œ/ì•„ì¼€ì´ë“œ ë¶€ë¬¸', name: 'í˜¸í…” ë” ê²Œì„', store: 'ì…œë¡í™ˆì¦ˆ ìˆ˜ì§€êµ¬ì²­ì '},
            {category: 'ë¬¸ì œ/ì•„ì¼€ì´ë“œ ë¶€ë¬¸', name: 'Escape Company', store: 'ì´ìŠ¤ì¼€ì´í”„ì›”ë“œ'},
            {category: 'ì½”ë¯¹ ë¶€ë¬¸', name: '(ìˆ˜)ì‚°ì—…ìŠ¤íŒŒì´', store: 'ì½”ë“œì´ìŠ¤ì¼€ì´í”„ ê°€ë¡œìˆ˜ê¸¸ì '},
            {category: 'ì½”ë¯¹ ë¶€ë¬¸', name: 'ìš©í•˜ë‹¤ ìš©í•´!! ìš©íŒ”ë„ë ¹', store: 'ì˜¤ëŠ˜ì˜ í•œ í˜ì´ì§€'},
            {category: 'ì½”ë¯¹ ë¶€ë¬¸', name: 'OKCUT', store: 'ìƒìƒì˜ë¬¸ ìˆ˜ì›2í˜¸ì '},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'ë‹¹ì‹  ì—†ì´ëŠ”', store: 'ì´ë¨¸ì‹œë¸Œ ìŠ¤íŠœë””ì˜¤'},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'ìƒì¡´ì', store: 'ë„¥ìŠ¤íŠ¸ì—ë””ì…˜ ê±´ëŒ€ 2í˜¸ì '},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'ì˜¤ëª¨í…Œë‚˜ì‹œ', store: 'ì„œìš¸ì´ìŠ¤ì¼€ì´í”„ë£¸ ëŒ€êµ¬ë™ì„±ë¡œì '},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'í”¼ë…¸í‚¤ì˜¤', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'AYAKO', store: 'í›„ì¦ˆë°ì–´'},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'Chapter 01 : ì„ íƒ', store: 'ë”ì±•í„°'},
            {category: 'ì¥ì¹˜ì—°ì¶œ ë¶€ë¬¸', name: 'OKCUT', store: 'ìƒìƒì˜ë¬¸ ìˆ˜ì›2í˜¸ì '},
            {category: 'ì—°ê¸°ì—°ì¶œ ë¶€ë¬¸', name: 'ë‹¹ì‹  ì—†ì´ëŠ”', store: 'ì´ë¨¸ì‹œë¸Œ ìŠ¤íŠœë””ì˜¤'},
            {category: 'ì—°ê¸°ì—°ì¶œ ë¶€ë¬¸', name: 'ìƒì¡´ì', store: 'ë„¥ìŠ¤íŠ¸ì—ë””ì…˜ ê±´ëŒ€ 2í˜¸ì '},
            {category: 'ì—°ê¸°ì—°ì¶œ ë¶€ë¬¸', name: 'ìš©í•˜ë‹¤ ìš©í•´!! ìš©íŒ”ë„ë ¹', store: 'ì˜¤ëŠ˜ì˜ í•œ í˜ì´ì§€'},
            {category: 'ì—°ê¸°ì—°ì¶œ ë¶€ë¬¸', name: 'ì¶˜í™”ê° : í”¼í•  ìˆ˜ ì—†ëŠ” ì €ì£¼', store: 'ìƒìƒì˜ë¬¸ ìˆ˜ì›2í˜¸ì '},
            {category: 'ì—°ê¸°ì—°ì¶œ ë¶€ë¬¸', name: 'í”¼ë…¸í‚¤ì˜¤', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ì—°ê¸°ì—°ì¶œ ë¶€ë¬¸', name: 'AYAKO', store: 'í›„ì¦ˆë°ì–´'},
            {category: 'ì¸í…Œë¦¬ì–´ ë¶€ë¬¸', name: 'ìƒì¡´ì', store: 'ë„¥ìŠ¤íŠ¸ì—ë””ì…˜ ê±´ëŒ€ 2í˜¸ì '},
            {category: 'ì¸í…Œë¦¬ì–´ ë¶€ë¬¸', name: 'ì˜¤ëª¨í…Œë‚˜ì‹œ', store: 'ì„œìš¸ì´ìŠ¤ì¼€ì´í”„ë£¸ ëŒ€êµ¬ë™ì„±ë¡œì '},
            {category: 'ì¸í…Œë¦¬ì–´ ë¶€ë¬¸', name: 'ì”í–¥', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ì¸í…Œë¦¬ì–´ ë¶€ë¬¸', name: 'í”Œë¼ì´ ë¯¸ íˆ¬ ë” ë¬¸', store: 'ë£¸ìµìŠ¤ì¼€ì´í”„ ì¸ë””ê³ ë¸”ë£¨ì '},
            {category: 'ì¸í…Œë¦¬ì–´ ë¶€ë¬¸', name: 'AYAKO', store: 'í›„ì¦ˆë°ì–´'},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'ë©”ê°€ ê²Œì„', store: 'ë£¸ì¦ˆì—ì´ ê°•ë‚¨ì '},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'ìƒì¡´ì', store: 'ë„¥ìŠ¤íŠ¸ì—ë””ì…˜ ê±´ëŒ€ 2í˜¸ì '},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'ì˜¤ëª¨í…Œë‚˜ì‹œ', store: 'ì„œìš¸ì´ìŠ¤ì¼€ì´í”„ë£¸ ëŒ€êµ¬ë™ì„±ë¡œì '},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'ì”í–¥', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'í”¼ë…¸í‚¤ì˜¤', store: 'ì§€êµ¬ë³„ ë°©íƒˆì¶œ í™ëŒ€ì–´ë“œë²¤ì³ì '},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'AYAKO', store: 'í›„ì¦ˆë°ì–´'},
            {category: 'ì˜¬í•´ì˜ í…Œë§ˆ ë¶€ë¬¸', name: 'Chapter 01 : ì„ íƒ', store: 'ë”ì±•í„°'}
        ];
        
        // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
        const categorizedThemes = {};
        themes.forEach(theme => {
            if (!categorizedThemes[theme.category]) {
                categorizedThemes[theme.category] = [];
            }
            categorizedThemes[theme.category].push(theme);
        });
        
        // íˆ¬í‘œ ë°ì´í„° ì €ì¥
        const voteData = {};
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        let hasVoted = false;
        let fingerprint = '';
        
        async function init() {
            // Fingerprint ìƒì„±
            const fp = await FingerprintJS.load();
            const result = await fp.get();
            fingerprint = result.visitorId;
            
            // íˆ¬í‘œ ì—¬ë¶€ í™•ì¸
            const voted = localStorage.getItem('hasVoted');
            if (voted === 'true') {
                await checkVoteStatus();
            } else {
                renderVotingUI();
            }
        }
        
        async function checkVoteStatus() {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'check-vote',
                        fingerprint
                    })
                });
                
                const data = await response.json();
                
                if (data.hasVoted) {
                    hasVoted = true;
                    await showResults();
                } else {
                    localStorage.removeItem('hasVoted');
                    renderVotingUI();
                }
            } catch (err) {
                console.error('íˆ¬í‘œ í™•ì¸ ì˜¤ë¥˜:', err);
                renderVotingUI();
            }
        }
        
        function renderVotingUI() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            Object.keys(categorizedThemes).forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';
                
                const categoryTitle = document.createElement('h2');
                categoryTitle.className = 'category-title';
                categoryTitle.textContent = category;
                categoryDiv.appendChild(categoryTitle);
                
                // ë±ƒì§€ ì»¨í…Œì´ë„ˆ
                const badgeContainer = document.createElement('div');
                badgeContainer.className = 'badge-container';
                badgeContainer.innerHTML = `
                    <div class="badge gold" draggable="true" data-rank="1" data-category="${category}">ğŸ¥‡</div>
                    <div class="badge silver" draggable="true" data-rank="2" data-category="${category}">ğŸ¥ˆ</div>
                    <div class="badge bronze" draggable="true" data-rank="3" data-category="${category}">ğŸ¥‰</div>
                `;
                categoryDiv.appendChild(badgeContainer);
                
                // í…Œë§ˆ ê·¸ë¦¬ë“œ
                const themesGrid = document.createElement('div');
                themesGrid.className = 'themes-grid';
                
                categorizedThemes[category].forEach(theme => {
                    const themeCard = document.createElement('div');
                    themeCard.className = 'theme-card';
                    themeCard.dataset.category = category;
                    themeCard.dataset.theme = theme.name;
                    themeCard.dataset.store = theme.store;
                    
                    themeCard.innerHTML = `
                        <img class="theme-poster" src="ai/crm/í¬ìŠ¤í„°/${theme.name}.jpg" 
                             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22280%22 height=%22200%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22280%22 height=%22200%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22%23999%22%3Eí¬ìŠ¤í„° ì¤€ë¹„ì¤‘%3C/text%3E%3C/svg%3E'" 
                             alt="${theme.name}">
                        <div class="theme-name">${theme.name}</div>
                        <div class="store-name">${theme.store}</div>
                        <div class="badge-drop-zone" data-category="${category}" data-theme="${theme.name}">
                            ë©”ë‹¬ì„ ë“œë˜ê·¸í•˜ì—¬ ë°°ì¹˜í•˜ì„¸ìš”
                        </div>
                    `;
                    
                    themesGrid.appendChild(themeCard);
                });
                
                categoryDiv.appendChild(themesGrid);
                container.appendChild(categoryDiv);
            });
            
            // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸ ì„¤ì •
            setupDragAndDrop();
        }
        
        function setupDragAndDrop() {
            const badges = document.querySelectorAll('.badge');
            const dropZones = document.querySelectorAll('.badge-drop-zone');
            
            badges.forEach(badge => {
                badge.addEventListener('dragstart', handleDragStart);
                badge.addEventListener('dragend', handleDragEnd);
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
        }
        
        let draggedElement = null;
        
        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }
        
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            const category = draggedElement.dataset.category;
            const zoneCategory = e.currentTarget.dataset.category;
            
            if (category === zoneCategory && !e.currentTarget.classList.contains('has-badge')) {
                e.currentTarget.closest('.theme-card').classList.add('drop-zone-active');
            }
        }
        
        function handleDragLeave(e) {
            e.currentTarget.closest('.theme-card').classList.remove('drop-zone-active');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.closest('.theme-card').classList.remove('drop-zone-active');
            
            const category = draggedElement.dataset.category;
            const zoneCategory = e.currentTarget.dataset.category;
            const rank = draggedElement.dataset.rank;
            const theme = e.currentTarget.dataset.theme;
            
            if (category !== zoneCategory || e.currentTarget.classList.contains('has-badge')) {
                return;
            }
            
            // ê°™ì€ ì¹´í…Œê³ ë¦¬ì—ì„œ ê°™ì€ ë­í¬ê°€ ì´ë¯¸ ë°°ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            const existingBadge = document.querySelector(
                `.placed-badge[data-category="${category}"][data-rank="${rank}"]`
            );
            if (existingBadge) {
                const oldZone = existingBadge.parentElement;
                oldZone.innerHTML = 'ë©”ë‹¬ì„ ë“œë˜ê·¸í•˜ì—¬ ë°°ì¹˜í•˜ì„¸ìš”';
                oldZone.classList.remove('has-badge');
                
                const oldTheme = oldZone.dataset.theme;
                delete voteData[`${category}|${oldTheme}`];
            }
            
            // ë±ƒì§€ ë°°ì¹˜
            const badgeClass = rank === '1' ? 'gold' : rank === '2' ? 'silver' : 'bronze';
            const badgeIcon = rank === '1' ? 'ğŸ¥‡' : rank === '2' ? 'ğŸ¥ˆ' : 'ğŸ¥‰';
            
            e.currentTarget.innerHTML = `
                <div class="placed-badge ${badgeClass}" 
                     data-category="${category}" 
                     data-rank="${rank}"
                     onclick="removeBadge(this)">
                    ${badgeIcon}
                </div>
            `;
            e.currentTarget.classList.add('has-badge');
            
            // íˆ¬í‘œ ë°ì´í„° ì €ì¥
            voteData[`${category}|${theme}`] = {
                category,
                theme,
                store: e.currentTarget.closest('.theme-card').dataset.store,
                rank: parseInt(rank)
            };
        }
        
        function removeBadge(badge) {
            const zone = badge.parentElement;
            const category = badge.dataset.category;
            const theme = zone.dataset.theme;
            
            zone.innerHTML = 'ë©”ë‹¬ì„ ë“œë˜ê·¸í•˜ì—¬ ë°°ì¹˜í•˜ì„¸ìš”';
            zone.classList.remove('has-badge');
            
            delete voteData[`${category}|${theme}`];
        }
        
        async function submitVote() {
            if (Object.keys(voteData).length === 0) {
                alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ í…Œë§ˆì— ë©”ë‹¬ì„ ë°°ì¹˜í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            if (!confirm('íˆ¬í‘œë¥¼ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì œì¶œ í›„ì—ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                return;
            }
            
            try {
                // IP ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸°
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const ipAddress = ipData.ip;
                
                // íˆ¬í‘œ ì œì¶œ
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'submit-vote',
                        ipAddress,
                        fingerprint,
                        votes: Object.values(voteData)
                    })
                });
                
                if (response.status === 409) {
                    alert('ì´ë¯¸ íˆ¬í‘œí•˜ì…¨ìŠµë‹ˆë‹¤!');
                    localStorage.setItem('hasVoted', 'true');
                    await showResults();
                    return;
                }
                
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                localStorage.setItem('hasVoted', 'true');
                alert('íˆ¬í‘œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
                await showResults();
                
            } catch (error) {
                console.error('íˆ¬í‘œ ì œì¶œ ì˜¤ë¥˜:', error);
                alert('íˆ¬í‘œ ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        }
        
        async function showResults() {
            document.getElementById('votingSection').style.display = 'none';
            document.getElementById('resultsSection').classList.add('show');
            
            const resultsContainer = document.getElementById('resultsContainer');
            resultsContainer.innerHTML = '<div class="loading">ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
            
            try {
                // ì¹´í…Œê³ ë¦¬ë³„ ê²°ê³¼ ì¡°íšŒ
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'get-results' })
                });
                
                const data = await response.json();
                
                if (data.error) throw new Error(data.error);
                
                const results = data.results;
                
                // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
                const resultsByCategory = {};
                results.forEach(result => {
                    if (!resultsByCategory[result.category]) {
                        resultsByCategory[result.category] = [];
                    }
                    resultsByCategory[result.category].push(result);
                });
                
                // ê²°ê³¼ ë Œë”ë§
                resultsContainer.innerHTML = '';
                Object.keys(resultsByCategory).forEach(category => {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'result-category';
                    
                    const title = document.createElement('h2');
                    title.className = 'category-title';
                    title.textContent = category;
                    categoryDiv.appendChild(title);
                    
                    resultsByCategory[category].forEach((result, index) => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'result-item';
                        resultItem.innerHTML = `
                            <div class="result-rank">${index + 1}</div>
                            <div class="result-info">
                                <div class="result-theme">${result.theme_name}</div>
                                <div class="result-store">${result.store_name}</div>
                            </div>
                            <div class="result-badges">
                                <span class="result-badge-count">ğŸ¥‡ ${result.gold_count}</span>
                                <span class="result-badge-count">ğŸ¥ˆ ${result.silver_count}</span>
                                <span class="result-badge-count">ğŸ¥‰ ${result.bronze_count}</span>
                            </div>
                            <div class="result-points">${result.total_points}ì </div>
                        `;
                        categoryDiv.appendChild(resultItem);
                    });
                    
                    resultsContainer.appendChild(categoryDiv);
                });
                
                // ë§¤ì¥ ë­í‚¹ ì¡°íšŒ
                await showStoreRankings();
                
            } catch (error) {
                console.error('ê²°ê³¼ ì¡°íšŒ ì˜¤ë¥˜:', error);
                resultsContainer.innerHTML = '<div class="error">ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
            }
        }
        
        async function showStoreRankings() {
            const container = document.getElementById('storeRankings');
            container.innerHTML = '<div class="loading">ë§¤ì¥ ìˆœìœ„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'get-store-rankings' })
                });
                
                const data = await response.json();
                
                if (data.error) throw new Error(data.error);
                
                const rankings = data.rankings;
                
                container.innerHTML = '';
                rankings.forEach((store, index) => {
                    const medal = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : '';
                    const item = document.createElement('div');
                    item.className = 'store-rank-item';
                    item.innerHTML = `
                        <div class="result-rank">${medal} ${index + 1}</div>
                        <div class="result-info">
                            <div class="result-theme">${store.store_name}</div>
                            <div class="result-store">í…Œë§ˆ ìˆ˜: ${store.theme_count}ê°œ</div>
                        </div>
                        <div class="result-points">${store.total_points}ì </div>
                    `;
                    container.appendChild(item);
                });
                
            } catch (error) {
                console.error('ë§¤ì¥ ìˆœìœ„ ì¡°íšŒ ì˜¤ë¥˜:', error);
                container.innerHTML = '<div class="error">ë§¤ì¥ ìˆœìœ„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        init();
    </script>
</body>
</html>